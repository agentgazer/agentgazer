# Spec: Security Dashboard

## Overview

Dashboard page for configuring security settings per agent.

## Page Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Settings                     Apply to: [ ALL â–¼ ]            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ›¡ï¸ Prompt Injection Detection                          [toggle] â”‚ â”‚
â”‚  â”‚    Action when detected: [ Alert â–¼ ]                             â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Ignore previous instructions                      â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] System prompt override                            â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Role hijacking                                    â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Jailbreak patterns                                â”‚ â”‚
â”‚  â”‚    â””â”€ Custom patterns                           [+ Add Pattern]  â”‚ â”‚
â”‚  â”‚        â””â”€ "my pattern" [Edit] [Ã—]                                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”’ Sensitive Data Masking                               [toggle] â”‚ â”‚
â”‚  â”‚    Mask with: [ [REDACTED] â–¼ ]                                   â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] API Keys                                          â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Credit Card Numbers                               â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Personal Data                                     â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Crypto Wallets & Keys                             â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Environment Variables                             â”‚ â”‚
â”‚  â”‚    â””â”€ Custom patterns                           [+ Add Pattern]  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ”§ Tool Call Restrictions                               [toggle] â”‚ â”‚
â”‚  â”‚    Action when violated: [ Block â–¼ ]                             â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Max calls per request    [ 10 ]                   â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Max calls per minute     [ 60 ]                   â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Block filesystem tools                            â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Block network tools                               â”‚ â”‚
â”‚  â”‚    â”œâ”€ [toggle] Block code execution                              â”‚ â”‚
â”‚  â”‚    â””â”€ Tool allowlist/blocklist                  [Configure...]   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ğŸ“Š Security Events                                               â”‚ â”‚
â”‚  â”‚    Filters: [Type â–¼] [Severity â–¼] [Time Range â–¼]                â”‚ â”‚
â”‚  â”‚                                                                   â”‚ â”‚
â”‚  â”‚    Time     Type              Severity  Action   Rule            â”‚ â”‚
â”‚  â”‚    12:34    prompt_injection  critical  blocked  ignore_instr    â”‚ â”‚
â”‚  â”‚    12:30    data_masked       info      masked   credit_card     â”‚ â”‚
â”‚  â”‚    12:28    tool_blocked      warning   blocked  max_per_min     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Toggle Logic

### Parent Toggle States
- **ON** (â—): All children enabled
- **OFF** (â—‹): All children disabled
- **PARTIAL** (â—): Some children enabled

### Parent Toggle Behavior
- Click ON â†’ All OFF
- Click OFF â†’ All ON
- Click PARTIAL â†’ All ON

### Visual Indicators
```tsx
// Toggle component with three states
<ParentToggle
  state={allOn ? 'on' : allOff ? 'off' : 'partial'}
  onChange={(newState) => {
    if (newState === 'on') setAllChildren(true);
    else setAllChildren(false);
  }}
/>
```

## Agent Selector

Dropdown options:
- "ALL" (default config)
- List of known agents from database

When agent is selected:
1. Load config for that agent
2. If no config exists, show global defaults
3. Save creates agent-specific config

## Custom Pattern Modal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Add Custom Pattern                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚ Name:    [________________________]         â”‚
â”‚                                             â”‚
â”‚ Pattern: [________________________]         â”‚
â”‚          (Regular expression)               â”‚
â”‚                                             â”‚
â”‚ Test:    [________________________]         â”‚
â”‚          [Test Pattern]                     â”‚
â”‚                                             â”‚
â”‚ Result:  âœ“ Matches / âœ— No match            â”‚
â”‚                                             â”‚
â”‚          [Cancel]  [Save]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Sidebar Navigation

Add to Layout.tsx NAV_ITEMS:
```tsx
{ path: '/security', label: 'Security', icon: ShieldIcon }
```

Position: After Alerts, before Settings
